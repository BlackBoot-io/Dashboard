import React, { useMemo } from "react";
import { Navigate, Outlet, useLocation } from "react-router-dom";
import { Layout as AntLayout, Drawer } from "antd";
import storageKeys from "../../config/storageKeys";
import { useDispatch, useSelector } from "react-redux";
import Splash from "components/Splash";
import Menu from "components/Panel/comps/Menu";
import routes from "config/routes";
import { useTranslation } from "react-i18next";
import { toggle } from "redux/drawer";
import Header from "components/Panel/comps/Header";

const { Sider, Content } = AntLayout;
const Layout = ({}) => {
  let token = localStorage.getItem(storageKeys.token);
  const { isOpen } = useSelector((x) => x.drawer);
  const { user } = useSelector((x) => x.auth);
  const { lightMode } = useSelector((x) => x.theme);
  const dispatch = useDispatch();
  const location = useLocation();
  const { t, i18n } = useTranslation();
  const menus = useMemo(
    () => [
      {
        key: "overview",
        label: t("overview"),
        icon: (
          <svg
            width="30"
            height="30"
            viewBox="0 0 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M11.7725 12.5007H8.2275C7.70734 12.4964 7.20676 12.6988 6.83591 13.0636C6.46505 13.4284 6.25429 13.9255 6.25 14.4457V21.8069C6.25962 22.8896 7.1448 23.7597 8.2275 23.7507H11.7725C12.2927 23.755 12.7932 23.5525 13.1641 23.1878C13.5349 22.823 13.7457 22.3258 13.75 21.8057V14.4457C13.7457 13.9255 13.5349 13.4284 13.1641 13.0636C12.7932 12.6988 12.2927 12.4964 11.7725 12.5007Z"
              stroke="#1EABCC"
              strokeWidth="1.5"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M11.7725 5.00075H8.2275C7.16657 4.97133 6.28198 5.80615 6.25 6.867V8.1345C6.28198 9.19536 7.16657 10.0302 8.2275 10.0008H11.7725C12.8334 10.0302 13.718 9.19536 13.75 8.1345V6.867C13.718 5.80615 12.8334 4.97133 11.7725 5.00075Z"
              strokeWidth="1.5"
              strokeLinecap="round"
              strokeLinejoin="round"
              stroke={lightMode?"black":"white"}
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M18.2275 16.2508H21.7712C22.2916 16.2555 22.7925 16.0531 23.1637 15.6883C23.5348 15.3235 23.7457 14.8262 23.75 14.3058V6.9458C23.7457 6.42564 23.5349 5.92849 23.1641 5.56373C22.7932 5.19896 22.2927 4.99647 21.7725 5.0008H18.2275C17.7073 4.99647 17.2068 5.19896 16.8359 5.56373C16.4651 5.92849 16.2543 6.42564 16.25 6.9458V14.3058C16.2543 14.826 16.4651 15.3231 16.8359 15.6879C17.2068 16.0526 17.7073 16.2551 18.2275 16.2508Z"
              stroke="#1EABCC"
              strokeWidth="1.5"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M18.2275 23.7508H21.7712C22.8327 23.7809 23.718 22.9459 23.75 21.8845V20.617C23.718 19.5561 22.8334 18.7213 21.7725 18.7508H18.2275C17.1666 18.7213 16.282 19.5561 16.25 20.617V21.8833C16.2813 22.9446 17.1661 23.7802 18.2275 23.7508Z"
              strokeWidth="1.5"
              strokeLinecap="round"
              strokeLinejoin="round"
              stroke={lightMode?"black":"white"}
            />
          </svg>
        ),
        children: [
          {
            key: routes.dashboard,
            label: t("dashbord"),
            icon: (
              <svg
                width="30"
                height="30"
                viewBox="0 0 30 30"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M11.7725 12.5007H8.2275C7.70734 12.4964 7.20676 12.6988 6.83591 13.0636C6.46505 13.4284 6.25429 13.9255 6.25 14.4457V21.8069C6.25962 22.8896 7.1448 23.7597 8.2275 23.7507H11.7725C12.2927 23.755 12.7932 23.5525 13.1641 23.1878C13.5349 22.823 13.7457 22.3258 13.75 21.8057V14.4457C13.7457 13.9255 13.5349 13.4284 13.1641 13.0636C12.7932 12.6988 12.2927 12.4964 11.7725 12.5007Z"
                  stroke="#1EABCC"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M11.7725 5.00075H8.2275C7.16657 4.97133 6.28198 5.80615 6.25 6.867V8.1345C6.28198 9.19536 7.16657 10.0302 8.2275 10.0008H11.7725C12.8334 10.0302 13.718 9.19536 13.75 8.1345V6.867C13.718 5.80615 12.8334 4.97133 11.7725 5.00075Z"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M18.2275 16.2508H21.7712C22.2916 16.2555 22.7925 16.0531 23.1637 15.6883C23.5348 15.3235 23.7457 14.8262 23.75 14.3058V6.9458C23.7457 6.42564 23.5349 5.92849 23.1641 5.56373C22.7932 5.19896 22.2927 4.99647 21.7725 5.0008H18.2275C17.7073 4.99647 17.2068 5.19896 16.8359 5.56373C16.4651 5.92849 16.2543 6.42564 16.25 6.9458V14.3058C16.2543 14.826 16.4651 15.3231 16.8359 15.6879C17.2068 16.0526 17.7073 16.2551 18.2275 16.2508Z"
                  stroke="#1EABCC"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M18.2275 23.7508H21.7712C22.8327 23.7809 23.718 22.9459 23.75 21.8845V20.617C23.718 19.5561 22.8334 18.7213 21.7725 18.7508H18.2275C17.1666 18.7213 16.282 19.5561 16.25 20.617V21.8833C16.2813 22.9446 17.1661 23.7802 18.2275 23.7508Z"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            ),
          },
          {
            key: routes.transactions,
            label: t("transactions"),
            icon: (
              <svg
                width="25"
                height="25"
                viewBox="0 0 25 25"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19.7917 13.125H15.9771L14.0698 9.375L10.7292 15.625L9.30108 13.125H5.20837"
                  stroke="#989AA3"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            ),
          },
          {
            key: routes.crowdsaleSchedule,
            label: t("crowdsaleSchedule"),
            icon: (
              <svg
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M3.89554 11.7456L6.20096 16.592C6.55139 17.1179 7.14576 17.4289 7.77763 17.417H13.3051C13.937 17.4289 14.5314 17.1179 14.8818 16.592L17.1872 11.7419C17.4964 11.2628 17.4964 10.647 17.1872 10.168L14.8946 5.4013C14.544 4.88079 13.9537 4.57308 13.3262 4.58364H10.5405H7.75471C7.12719 4.57308 6.53695 4.88079 6.18629 5.4013L3.89921 10.1753C3.59043 10.6528 3.589 11.2666 3.89554 11.7456Z"
                  stroke="#989AA3"
                  stroke-ÙŒidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            ),
          },
        ],
      },
      {
        key: routes.buyToken,
        label: t("buyToken"),
        icon: (
          <svg
            width="30"
            height="30"
            viewBox="0 0 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M18.3651 6.25H11.6351C10.1989 6.25793 8.82475 6.83607 7.81486 7.85721C6.80497 8.87835 6.24211 10.2588 6.25008 11.695V18.305C6.25009 18.5168 6.2622 18.7284 6.28633 18.9388C6.58908 21.6679 8.8892 23.7369 11.6351 23.75H18.3651C19.8012 23.7421 21.1754 23.1639 22.1853 22.1428C23.1952 21.1217 23.7581 19.7412 23.7501 18.305V11.695C23.7581 10.2588 23.1952 8.87835 22.1853 7.85721C21.1754 6.83607 19.8012 6.25793 18.3651 6.25Z"
              stroke={lightMode?"#023047":"white"}
              strokeWidth="1.5"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <path
              d="M11.4165 16.7493C11.4165 16.4732 11.1926 16.2493 10.9165 16.2493C10.6404 16.2493 10.4165 16.4732 10.4165 16.7493H11.4165ZM10.9165 17.3327H10.4165H10.9165ZM19.5832 16.7493C19.5832 16.4732 19.3593 16.2493 19.0832 16.2493C18.807 16.2493 18.5832 16.4732 18.5832 16.7493H19.5832ZM14.6094 17.0203C14.4369 17.236 14.4719 17.5506 14.6875 17.7231C14.9031 17.8956 15.2178 17.8607 15.3903 17.645L14.6094 17.0203ZM17.7236 14.7284C17.8961 14.5127 17.8611 14.1981 17.6455 14.0256C17.4299 13.8531 17.1152 13.888 16.9427 14.1037L17.7236 14.7284ZM14.6094 17.645C14.7819 17.8607 15.0966 17.8956 15.3122 17.7231C15.5278 17.5506 15.5628 17.236 15.3903 17.0203L14.6094 17.645ZM13.0569 14.1037C12.8844 13.888 12.5698 13.8531 12.3542 14.0256C12.1385 14.1981 12.1036 14.5127 12.2761 14.7284L13.0569 14.1037ZM14.4998 17.3327C14.4998 17.6088 14.7237 17.8327 14.9998 17.8327C15.276 17.8327 15.4998 17.6088 15.4998 17.3327H14.4998ZM15.4998 10.916C15.4998 10.6399 15.276 10.416 14.9998 10.416C14.7237 10.416 14.4998 10.6399 14.4998 10.916H15.4998ZM10.4165 16.7493L10.4165 17.3327H11.4165V16.7493H10.4165ZM10.4165 17.3327C10.4165 18.5753 11.4239 19.5827 12.6665 19.5827V18.5827C11.9761 18.5827 11.4165 18.023 11.4165 17.3327H10.4165ZM12.6665 19.5827H17.3332V18.5827H12.6665V19.5827ZM17.3332 19.5827C18.5758 19.5827 19.5832 18.5753 19.5832 17.3327H18.5832C18.5832 18.023 18.0235 18.5827 17.3332 18.5827V19.5827ZM19.5832 17.3327V16.7493H18.5832V17.3327H19.5832ZM15.3903 17.645L17.7236 14.7284L16.9427 14.1037L14.6094 17.0203L15.3903 17.645ZM15.3903 17.0203L13.0569 14.1037L12.2761 14.7284L14.6094 17.645L15.3903 17.0203ZM15.4998 17.3327V10.916H14.4998V17.3327H15.4998Z"
              fill="#009C7B"
            />
          </svg>
        ),
      },
      {
        key: routes.withdrawToken,
        label: t("withdrawToken"),
        icon: (
          <svg
            width="30"
            height="30"
            viewBox="0 0 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M18.3651 6.25H11.6351C10.1989 6.25793 8.82475 6.83607 7.81486 7.85721C6.80497 8.87835 6.24211 10.2588 6.25008 11.695V18.305C6.25009 18.5168 6.2622 18.7284 6.28633 18.9388C6.58908 21.6679 8.8892 23.7369 11.6351 23.75H18.3651C19.8012 23.7421 21.1754 23.1639 22.1853 22.1428C23.1952 21.1217 23.7581 19.7412 23.7501 18.305V11.695C23.7581 10.2588 23.1952 8.87835 22.1853 7.85721C21.1754 6.83607 19.8012 6.25793 18.3651 6.25Z"
              stroke={lightMode?"#023047":"white"}
              strokeWidth="1.5"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <path
              d="M11.5 16.7141C11.5 16.438 11.2761 16.2141 11 16.2141C10.7239 16.2141 10.5 16.438 10.5 16.7141H11.5ZM11 17.2856H10.5H11ZM19.4148 16.7141C19.4148 16.438 19.1909 16.2141 18.9148 16.2141C18.6386 16.2141 18.4148 16.438 18.4148 16.7141H19.4148ZM15.3494 11.3103C15.5208 11.0938 15.4842 10.7793 15.2677 10.6079C15.0512 10.4366 14.7367 10.4732 14.5653 10.6897L15.3494 11.3103ZM12.304 13.5468C12.1326 13.7634 12.1692 14.0778 12.3857 14.2492C12.6022 14.4206 12.9167 14.384 13.0881 14.1674L12.304 13.5468ZM15.3496 10.6897C15.1782 10.4732 14.8637 10.4366 14.6472 10.6079C14.4307 10.7793 14.3941 11.0938 14.5654 11.3103L15.3496 10.6897ZM16.8268 14.1674C16.9982 14.384 17.3126 14.4206 17.5292 14.2492C17.7457 14.0778 17.7823 13.7634 17.6109 13.5468L16.8268 14.1674ZM15.4573 11C15.4573 10.7239 15.2334 10.5 14.9573 10.5C14.6811 10.5 14.4573 10.7239 14.4573 11H15.4573ZM14.4573 17.2857C14.4573 17.5619 14.6811 17.7857 14.9573 17.7857C15.2334 17.7857 15.4573 17.5619 15.4573 17.2857H14.4573ZM10.5 16.7141V17.2856H11.5V16.7141H10.5ZM10.5 17.2856C10.5 18.5034 11.4782 19.4998 12.696 19.4998V18.4998C12.0405 18.4998 11.5 17.9613 11.5 17.2856H10.5ZM12.696 19.4998H17.2187V18.4998H12.696V19.4998ZM17.2187 19.4998C18.4366 19.4998 19.4148 18.5034 19.4148 17.2856H18.4148C18.4148 17.9613 17.8743 18.4998 17.2187 18.4998V19.4998ZM19.4148 17.2856V16.7141H18.4148V17.2856H19.4148ZM14.5653 10.6897L12.304 13.5468L13.0881 14.1674L15.3494 11.3103L14.5653 10.6897ZM14.5654 11.3103L16.8268 14.1674L17.6109 13.5468L15.3496 10.6897L14.5654 11.3103ZM14.4573 11V17.2857H15.4573V11H14.4573Z"
              fill="#FF0000"
            />
          </svg>
        ),
      },
      {
        key: routes.notifications,
        label: t("notifications"),
        icon: (
          <svg
            width="27"
            height="27"
            viewBox="0 0 27 27"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M7.28443 14.0209C7.15392 10.4536 9.93434 7.45334 13.5012 7.3125C17.068 7.45334 19.8484 10.4536 19.7179 14.0209C19.7179 15.5025 21.3278 16.9459 21.3751 18.4309C21.3751 18.4519 21.3751 18.4729 21.3751 18.4939C21.4099 19.4453 20.6681 20.2454 19.7168 20.2826H16.1258C16.1291 21.0117 15.8543 21.7145 15.3574 22.248C14.8796 22.7669 14.2065 23.0621 13.5012 23.0621C12.7959 23.0621 12.1227 22.7669 11.6449 22.248C11.148 21.7145 10.8732 21.0117 10.8766 20.2826H7.28443C6.3331 20.2454 5.59134 19.4453 5.62618 18.4939C5.62618 18.4729 5.62618 18.4519 5.62618 18.4309C5.67455 16.9504 7.28443 15.5036 7.28443 14.0209Z"
              strokeWidth="1.5"
              strokeLinecap="round"
              strokeLinejoin="round"
              stroke={lightMode ? "black" : "white"}
            />
            <path
              d="M10.8766 19.5326C10.4624 19.5326 10.1266 19.8684 10.1266 20.2826C10.1266 20.6968 10.4624 21.0326 10.8766 21.0326V19.5326ZM16.1258 21.0326C16.54 21.0326 16.8758 20.6968 16.8758 20.2826C16.8758 19.8684 16.54 19.5326 16.1258 19.5326V21.0326ZM14.6262 5.8125C15.0404 5.8125 15.3762 5.47671 15.3762 5.0625C15.3762 4.64829 15.0404 4.3125 14.6262 4.3125V5.8125ZM12.3762 4.3125C11.962 4.3125 11.6262 4.64829 11.6262 5.0625C11.6262 5.47671 11.962 5.8125 12.3762 5.8125V4.3125ZM10.8766 21.0326H16.1258V19.5326H10.8766V21.0326ZM14.6262 4.3125H12.3762V5.8125H14.6262V4.3125Z"
              fill={lightMode ? "black" : "white"}
            />
            <line
              x1="11.875"
              y1="5.125"
              x2="15.125"
              y2="5.125"
              stroke="#FF7E00"
              strokeWidth="1.75"
              strokeLinecap="round"
            />
          </svg>
        ),
      },
    ],
    [lightMode]
  );
  if (user)
    return (
      <AntLayout id="main-layout">
        <Drawer
          placement={i18n.dir() === "rtl" ? "right" : "left"}
          onClose={() => dispatch(toggle())}
          visible={isOpen}
          className="drawer"
        >
          <Menu items={menus} mobileSize={true} />
        </Drawer>
        <Sider width={257}>
          <Menu items={menus} mobileSize={false} />
        </Sider>
        <AntLayout>
          <Header />
          <Content>
            <Outlet />
          </Content>
        </AntLayout>
      </AntLayout>
    );
  else if (token) return <Splash />;
  else
    return (
      <Navigate
        to={`/${routes.auth}/${routes.login}`}
        state={{ from: location }}
        replace
      />
    );
};
export default Layout;
